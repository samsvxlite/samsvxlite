<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>WIX Tool - samsVX Lite</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "WIX Tool";
    var mkdocs_page_input_path = "wixtool.md";
    var mkdocs_page_url = "/wixtool/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> samsVX Lite</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Coding</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../style/">Style</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Tech</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../postgresql/">PostgreSQL</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../rabbitmq/">RabbitMQ</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">WIX Tool</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#_1">설치</a></li>
                
            
                <li class="toctree-l3"><a href="#_2">개요</a></li>
                
            
                <li class="toctree-l3"><a href="#_3">정말 간단한 설치 파일 생성 예제</a></li>
                
            
                <li class="toctree-l3"><a href="#wixsharp">WixSharp</a></li>
                
            
                <li class="toctree-l3"><a href="#wixsharp_1">WixSharp으로 간단한 설치 파일 생성 하기</a></li>
                
            
                <li class="toctree-l3"><a href="#wixsharp-project-templates">WixSharp Project Templates</a></li>
                
            
                <li class="toctree-l3"><a href="#wixsharp_2">WixSharp으로 서비스 프로그램 설치</a></li>
                
            
                <li class="toctree-l3"><a href="#wixsharp_3">WixSharp으로 복수개의 설치 프로그램 포함 하기</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../ddd/">Domain Driven Design</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">samsVX Lite</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Tech &raquo;</li>
        
      
    
    <li>WIX Tool</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="_1">설치</h1>
<ul>
<li>
<p>다음의 URL에서 최신 버전의 WiX를 받아 설치를 진행 한다.</p>
<p><a href="http://wixtoolset.org/releases/">WIX TOOL SET</a></p>
</li>
</ul>
<hr />
<p><br/></p>
<h1 id="_2">개요</h1>
<p>WiX toolset은 xml을 이용하여 윈도우 설치 파일을 생성해 낸다.<br />
 UI를 지원하는 기본적인 설치 프로젝트를 사용하여 설치 파일을 생성하는 것과는<br />
 달리 프로그래밍 언어로 코딩을 하는 것처럼 설치 파일을 생성하게 된다. </p>
<p>WiX toolset을 사용하게 될 경우의 이점은 다음과 같다.</p>
<ul>
<li>선언적인 접근.(declarative approach)</li>
<li>제한 없이 윈도우 설치 기능들에 접근 할 수 있다.(unrestricted access to Windows Installer fuctionality)</li>
<li>GUI 기반이 아닌 Source code 기반이다,(? source code instead of GUI-based assembly of information)</li>
<li>어플리케이션 빌드 프로세스를 완벽하게 통합 할 수 있다.(complete integration into application build process)</li>
<li>어플리케이션 개발과 통합이 가능 하다.(possible integration with application development)</li>
<li>팀 단위 개발을 지원한다.(support for team development, both in-house and third-party)</li>
<li>무료다.(free, opensource)</li>
</ul>
<hr />
<p><br/></p>
<h1 id="_3">정말 간단한 설치 파일 생성 예제</h1>
<ul>
<li>WIX를 이용하여 간단한 설치 파일을 생성해 보자!</li>
</ul>
<p><strong>Step 1 : C# 윈도우 어플리케이션 프로젝트를 생성 한다.</strong></p>
<pre><code>1. C# 윈도우 어플리케이션 프로젝트 생성.
1. 셍략.
</code></pre>
<p><strong>Step 2 : 인스톨 프로젝트를 생성 한다.</strong></p>
<pre><code>1. 솔루션내 새 프로젝트 생성.
1. Windows Installer XML 프로젝트 선택.
1. C# 윈도우 어플리케이션 프로젝트를 설치 프로젝트에 참조 추가.
1. 설치 프로젝트 내 Product.wxs 파일을 확인.    
1. &lt;Product&gt; 항목의 Manufacturer="" 필드에 게시자를 작성해 준다. ex)Manufacturer="SHSystem"
1. &lt;Component&gt; 주변의 주석을 해제한 뒤 TODO의 내용을 삭제 한다.
1. &lt;Component&gt; 내 다음을 삽입 &lt;File Source="$(var.MyApplication.TargetPath)" /&gt;
    * MyApplication에는 생성한 C# 윈도우 어플리케이션 프로젝트 명칭을 써준다.
1. 설치 프로젝트 빌드 후 C:\Program Files (x86)\[Produect Name]에 설치가 제대로 진행 되었는지 확인 한다.
</code></pre>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Wix xmlns=&quot;http://schemas.microsoft.com/wix/2006/wi&quot;&gt;
    &lt;Product Id=&quot;*&quot; Name=&quot;SetupProject1&quot; Language=&quot;1033&quot; Version=&quot;1.0.0.0&quot; Manufacturer=&quot;&quot; UpgradeCode=&quot;12a0089a-c561-4bca-ac26-d9f9b244d753&quot;&gt;
        &lt;Package InstallerVersion=&quot;200&quot; Compressed=&quot;yes&quot; InstallScope=&quot;perMachine&quot; /&gt;

        &lt;MajorUpgrade DowngradeErrorMessage=&quot;A newer version of [ProductName] is already installed.&quot; /&gt;
        &lt;MediaTemplate /&gt;

        &lt;Feature Id=&quot;ProductFeature&quot; Title=&quot;SetupProject1&quot; Level=&quot;1&quot;&gt;
            &lt;ComponentGroupRef Id=&quot;ProductComponents&quot; /&gt;
        &lt;/Feature&gt;
    &lt;/Product&gt;

    &lt;Fragment&gt;
        &lt;Directory Id=&quot;TARGETDIR&quot; Name=&quot;SourceDir&quot;&gt;
            &lt;Directory Id=&quot;ProgramFilesFolder&quot;&gt;
                &lt;Directory Id=&quot;INSTALLFOLDER&quot; Name=&quot;SetupProject1&quot; /&gt;
            &lt;/Directory&gt;
        &lt;/Directory&gt;
    &lt;/Fragment&gt;

    &lt;Fragment&gt;
        &lt;ComponentGroup Id=&quot;ProductComponents&quot; Directory=&quot;INSTALLFOLDER&quot;&gt;
            &lt;!-- TODO: Remove the comments around this Component element and the ComponentRef below in order to add resources to this installer. --&gt;
            &lt;!-- &lt;Component Id=&quot;ProductComponent&quot;&gt; --&gt;
                &lt;!-- TODO: Insert files, registry keys, and other resources here. --&gt;
            &lt;!-- &lt;/Component&gt; --&gt;
        &lt;/ComponentGroup&gt;
    &lt;/Fragment&gt;
&lt;/Wix&gt;
</code></pre>

<hr />
<p><br/></p>
<h1 id="wixsharp">WixSharp</h1>
<p>Wix#은 C# syntax를 Wix syntax로 변환해주는 단순한 변환기이다.</p>
<p>Wix#의 컨셉은 매우 단순하다. Wix#의 소스 파일은 Wix# 클래스들의 인스턴스와 관계된 정의를 담고 있는 일반적인 C# 파일이다.
Wix#의 클래스들은 files, shortcuts, registry value 등과 같은 deployment entity들에 해당 된다. Wix# 소스 파일은 Wix# 엔진을 통해 Wix 소스 파일로 변환되며, (optionally) 자동적으로 MSI 파일로 컴파일 된다.</p>
<hr />
<p><br/></p>
<h1 id="wixsharp_1">WixSharp으로 간단한 설치 파일 생성 하기</h1>
<ul>
<li>
<p>텍스트 파일 하나를 포함하는 간단한 설치 파일을 생성 한다.</p>
<ol>
<li>
<p>Visual Stuio에서 Console Application Project를 생성 한다.</p>
</li>
<li>
<p>nuget을 이용해서 wixsharp을 설치 한다.</p>
</li>
<li>
<p>프로젝트 내 Files라는 폴더를 생성 한 후 Manual.txt 텍스트 파일을 생성 한다.</p>
</li>
<li>
<p>정상적으로 빌드 한 후 프로젝트 내 MyProduct.msi 파일을 실행 시킨 뒤 정상적으로 프로그램 설치가 진행 되는지 확인 한다.</p>
</li>
<li>
<p>program.cs 파일은 다음과 같다.</p>
</li>
</ol>
</li>
</ul>
<pre><code>    class Program
    {
        static void Main(string[] args)
        {
            //MyProduct라는 이름의 프로그램 설치 파일
            var project = new Project(&quot;MyProduct&quot;,
                //프로그램이 설치되는 경로
                  new Dir(@&quot;%ProgramFiles%\My Company\My Product&quot;,
                      //Manual.txt가 위치한 경로
                      new File(@&quot;Files\Docs\Manual.txt&quot;)));

            project.Id = Guid.NewGuid().ToString();

            Compiler.BuildMsi(project);
        }
    }
</code></pre>

<hr />
<p><br/></p>
<h1 id="wixsharp-project-templates">WixSharp Project Templates</h1>
<p>다음의 경로 <a href="https://marketplace.visualstudio.com/items?itemName=OlegShilo.WixSharpProjectTemplates">(URI)</a>에서
Visual Studio Project 템플릿을 받아서 설치를 진행 하면 Wixsharp 설치 프로젝트를 기본적으로 사용할 수 있다.</p>
<hr />
<p><br/></p>
<h1 id="wixsharp_2">WixSharp으로 서비스 프로그램 설치</h1>
<ol>
<li>
<p>Windows Servivce Application 프로젝트 생성</p>
</li>
<li>
<p>nuget을 이용해서 wixsharp를 설치 한다.</p>
</li>
<li>
<p>console 어플리케이션을 생성 하여 program.cs 파일을 다음과 같이 작성 한다.</p>
</li>
<li>
<p>빌드 후 프로젝트내 MyProduct.msi를 실행 후 정상 설치가 되었는지 확인 한다.</p>
</li>
</ol>
<pre><code>    File service;

            var project = new ManagedProject(&quot;MyProduct&quot;,
                            //MyProduct라는 이름의 프로그램을 %ProgramFiles%\My Company\My Product\에 설치 한다.
                             new Dir(new Id(&quot;PRODUCT_INSTALLDIR&quot;), @&quot;%ProgramFiles%\My Company\My Product&quot;,
                             //1.에서 생성한 서비스 프로그램의 실행 파일을 프로젝트 내 Files 폴더를 생성 하여 넣어 준다.
                             //혹은 서비스 프로그램의 경로를 넣어 준다.
                                 service = new File(@&quot;Files\Bin\SampleService.exe&quot;)
                                 ));

            service.ServiceInstaller = new ServiceInstaller
            {
                Name = &quot;SimpaleService&quot;,
                StartOn = SvcEvent.Install,
                StopOn = SvcEvent.InstallUninstall_Wait,
                RemoveOn = SvcEvent.Uninstall_Wait,
            };

            project.GUID = new Guid(&quot;6fe30b47-2577-43ad-9095-1861ba25889b&quot;);
            project.BuildMsi();
</code></pre>

<hr />
<p><br/></p>
<h1 id="wixsharp_3">WixSharp으로 복수개의 설치 프로그램 포함 하기</h1>
<p>프로그램 설치 전 다른 프로그램이 선행적으로 설치가 되어야 할 경우 wix의 bootstrapper를 통해 배포 할 수 있다.</p>
<blockquote>
<p>예제를 위해 eralang, rabbitmq 설치 파일이 필요</p>
</blockquote>
<ol>
<li>
<p>console 어플리케이션 프로젝트를 생성 한다.</p>
</li>
<li>
<p>nuget을 통해 wixsharp을 설치 한다.</p>
</li>
<li>
<p>console 어플리케이션의 program.cs를 다음과 같이 작성 한다.</p>
</li>
</ol>
<pre><code></code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ddd/" class="btn btn-neutral float-right" title="Domain Driven Design">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../rabbitmq/" class="btn btn-neutral" title="RabbitMQ"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../rabbitmq/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../ddd/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>

</body>
</html>
